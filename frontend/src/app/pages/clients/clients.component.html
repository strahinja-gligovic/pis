<app-title [title]="'Clients'"></app-title>
<alert *ngIf="success" type="success">
  <strong>Success!</strong>
</alert>
<alert *ngIf="error && !submitted" type="danger" [dismissible]="true">
  <strong>{{error.errmsg || 'Something unexpected happened.'}}</strong>
</alert>
<div class="row">
  <div class="col">
    <button type="button" [disabled]="submitted" class="btn btn-secondary" (click)="openClientModal()">Add Client</button>
  </div>
</div>

<div class="row">
  <div class="col">
    <ngx-datatable ngx-resize-watcher class="bootstrap" [rows]="clients" [columnMode]="'flex'" [headerHeight]="40" [footerHeight]="40"
      [rowHeight]="'auto'">
      <ngx-datatable-column name="First Name" prop="firstName" [resizeable]="false" [sortable]="false" [draggable]="false" [flexGrow]="2"></ngx-datatable-column>
      <ngx-datatable-column name="Last Name" prop="lastName" [resizeable]="false" [sortable]="false" [draggable]="false" [flexGrow]="2"></ngx-datatable-column>
      <ngx-datatable-column name="Email" prop="email" [resizeable]="false" [sortable]="false" [draggable]="false" [flexGrow]="2"></ngx-datatable-column>
      <ngx-datatable-column name="Date of Birth" prop="dob" [resizeable]="false" [sortable]="false" [draggable]="false" [flexGrow]="1">
        <ng-template let-dob="value" ngx-datatable-cell-template>
          <span>{{dob | date}}</span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Address" prop="address" [resizeable]="false" [sortable]="false" [draggable]="false" [flexGrow]="1">
        <ng-template let-address="value" ngx-datatable-cell-template>
          <span style="cursor: pointer;" (click)="openAddressModal(address, addressTemplate)">Click to view</span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Operations" [resizeable]="false" [sortable]="false" [draggable]="false" [flexGrow]="1">
        <ng-template ngx-datatable-header-template>
          &nbsp;
        </ng-template>
        <ng-template let-client="row" ngx-datatable-cell-template>
          <div>
            <span *ngIf="!submitted" (click)="openClientModal(client)">
              <i class="fas fa-pencil-alt fa-lg clickable"></i>
            </span>
            &nbsp;
            <span *ngIf="!submitted" (click)="deleteClient(client)">
              <i class="fas fa-trash fa-lg clickable"></i>
            </span>
          </div>
        </ng-template>
      </ngx-datatable-column>
    </ngx-datatable>
  </div>
</div>
